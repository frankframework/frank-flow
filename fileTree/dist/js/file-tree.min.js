"use strict";!function(a){a.fn.fileTree=function(b){function c(c){return b=a.extend(l,b),c.each(function(){var c=b,d=a(this),e='<ol class="tree">';c.data.forEach(function(a){e+="dir"===a.type?k(a):j(a)}),e+="</ol>",d.append(e),d.addClass("file-tree"),d.find("li.folder").addClass("mjs-nestedSortable-collapsed"),f(d),b.sortable?g(d):b.selectable&&h(d)})}function d(b){function c(b){var d=[];return a(b).children("ol").children("li").each(function(){var b={};b.id=a(this).data("id"),b.name=a(this).data("name"),b.type=a(this).data("type"),a(this).children("ol").children("li").length>0&&(b.children=c(a(this))),d.push(b)}),d}return c(b)}function e(a){return JSON.stringify(d(a))}function f(b){a(b).find(".tree li.folder > div").on("click",function(){a(this).closest("li").toggleClass("mjs-nestedSortable-collapsed").toggleClass("mjs-nestedSortable-expanded")})}function g(b){b.addClass("sortable"),a(b).find("> ol.tree").nestedSortable({forcePlaceholderSize:!0,handle:"span",helper:"clone",items:"li",opacity:.6,placeholder:"placeholder",revert:250,tabSize:20,tolerance:"pointer",toleranceElement:"> div",maxLevels:0,isTree:!0,expandOnHover:400,startCollapsed:!0})}function h(b){function c(c){a(b).find(".tree li.folder").removeClass("selected"),a(b).find(".tree li.file").removeClass("selected"),a(c).addClass("selected"),a(b).trigger("itemSelected",[c])}b.addClass("selectable"),a(b).find(".tree li.folder > div").on("click",function(b){c(a(this).parent())}),a(b).find(".tree li.file > div").on("click",function(b){c(a(this).parent())})}function i(a){var b="";return a.children.forEach(function(a){b+="dir"===a.type?k(a):j(a)}),b}function j(a){var c="";return c=void 0!==a.id?'<li class="file mjs-nestedSortable-no-nesting" data-id="'+a.id+'" data-type="file" data-name="'+a.name+'"><div>':'<li class="file mjs-nestedSortable-no-nesting"><div>',c=void 0!==a.url&&b.selectable!==!0?c+'<a href="'+a.url+'"><span></span>'+a.name+"</a></div></li>":c+"<span></span>"+a.name+"</div></li>"}function k(a){var b;return b=void 0!==a.id?'<li class="folder" data-id="'+a.id+'" data-type="folder" data-name="'+a.name+'" ><div><span></span>'+a.name+"</div>":'<li class="folder"><div><span></span>'+a.name+"</div>",void 0!==a.children&&(b=b+"<ol>"+i(a)+"</ol>"),b+="</li>"}var l={data:void 0,sortable:!1,selectable:!1};switch(b){case"toObject":return d(this);case"toJson":return e(this);default:return c(this)}}}(jQuery);
